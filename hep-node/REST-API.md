# HEP Node API

## Basic Parameters
### Request
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| dapp_id           | string | Decentralized Application Id                             |
| protocol | string    | protocol name. The default is "HEP".                |
| version | string    | protocol version. The example is "1.0".                |
| ts        | number    | timestamp                                  |
| nonce            | string | random string or auto-increment sequence                              |
| md5            | string | HMAC authentication md5 checksum |

The timestamp and nonce fields is for preventing the replay attack.
The md5 message is generated by json string exclude md5 field.

### Response
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| message       | string    | error message         |
| errors       | json    | error list, see [error.json](schema/error.json) |

## NewNet

*** 

### newnet_cacheAuth
Caches the authentication request in DWeb use case.

#### Path
`
/newnet/cache/auth/
`

#### Parameters
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| uuid           | string | request uuid                             |
| action           | string | The value is "hep.auth.login"                             |
| scope            | int    | profile type Id. 1: base profile including name,head,newid; 2: advance profile including cellphone  |
| expired          | number | Expired timestamp                             |
| memo             | string | Login Memo,optional                             |
| sign_type             | string | Signature Type,aka cryptographic algorithm |
| signature        | string | signature hex string by application owner. The exclude fields is [sign_type, signature, md5, uuid]. |


#### Example Parameters
TBD

#### Returns
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| auth_hash           | string | The hash of auth information                             |

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
    "hash": "...."
}
```
   
*** 

### newnet_getAuthCache
Get the authentication information by given request hash.

#### Path
`
/newnet/cache/auth/:auth_hash/
`

#### Parameters
none

#### Example Parameters
TBD

#### Returns
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| uuid           | string | request uuid                             |
| dapp_id           | string | Decentralized Application Id                             |
| protocol | string    | protocol name. The default is "HEP".                |
| version | string    | protocol version. The example is "1.0".                |
| ts        | number    | timestamp                                  |
| nonce            | string | random string or auto-increment sequence                              |
| signature        | string | signature hex string by application owner |
| action           | string | The value is "login"                             |
| scope            | int    | profile type Id. 1: base profile including name,head,newid; 2: advance profile including cellphone  |
| expired          | number | Expired timestamp                             |
| memo             | string | Login Memo,optional                             |

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
    "uuid": "...",
    "signature": "...",
    "dapp_id": "...",
    "protocol": "....",
    "version": "1.0",
    "ts": 1559122027,
    "nonce": "...",
    "action": "...",
    "scope": 1,
    "expired": 1559122027,
    "memo": "...."
}
```

### newnet_newPayCache
#### Path
`
/newnet/cache/pay/
`

#### Parameters
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| uuid             | string | request uuid                             |
| action           | string | The value is "hep.pay.order"                             |
| expired          | number | Expired timestamp                             |
| description      | string | The order description |
| price_currency   | string | symbol of fiat or digital token, such as USD, CNY, NEW,BTC,ETH
| total_price      | string | amount of fiat or digital token, unit is the minimum unit of given fiat or digital token |
| order_number     | string | The order number. |
| seller           | string | The seller's NewID  |
| customer         | string | The customer's NewID |
| broker           | string | The broker's NewID. optional.  |
| sign_type        | string | Signature Type,aka cryptographic algorithm |
| signature        | string | signature hex string by application owner. The exclude fields is [sign_type, signature, md5, uuid]. |

#### Example Parameters
TBD

#### Returns
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| pay_hash           | string | The payment request hash                             |

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
    "pay_hash": "...."
}
```
   
*** 

### newnet_getPayCache
Get the payment information by given request hash.

#### Path
`
/newnet/cache/pay/:pay_hash/
`

#### Parameters
none

#### Example Parameters
TBD

#### Returns
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| uuid           | string | request uuid                             |
| dapp_id           | string | Decentralized Application Id                             |
| protocol | string    | protocol name. The default is "HEP".                |
| version | string    | protocol version. The example is "1.0".                |
| ts        | number    | timestamp                                  |
| nonce            | string | random string or auto-increment sequence                              |
| sign_type        | string | Signature Type,aka cryptographic algorithm |
| signature        | string | signature hex string by DApp owner. |
| action           | string | The value is "hep.pay.order". |
| expired          | number | Expired timestamp                             |
| description      | string | The order description |
| price_currency   | string | symbol of fiat or digital token, such as USD, CNY, NEW,BTC,ETH
| total_price      | string | amount of fiat or digital token, unit is the minimum unit of given fiat or digital token |
| order_number     | string | The order number. |
| seller           | string | The seller's NewID  |
| customer         | string | The customer's NewID |
| broker           | string | The broker's NewID.  |

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
    "uuid": "...",
    "dapp_id": "...",
    "protocol": "....",
    "version": "1.0",
    "ts": 1559122027,
    "nonce": "...",
    "signature": "...",
    "action": "...",
    "expired": 1559122027,
    ...
}
```

### newnet_newProofCache

#### Path
`
/newnet/cache/proof/
`

#### Parameters
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| content      | json | The content of proof. the format see below. |
| sign_type        | string | Signature Type,aka cryptographic algorithm |
| signature      | string | The signature by DApp owner. The exclude fields is [sign_type, signature, md5, uuid]. |
| action | string | "hep.proof.submit" |
| uuid           | string | request uuid                             |

##### Order Proof Parameters
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| type           | string | The value is "order"                             |
| description      | string | The order description |
| price_currency   | string | symbol of fiat or digital token, such as USD, RMB, NEW,BTC,ETH
| total_price      | string | amount of fiat or digital token, unit is the minimum unit of given fiat or digital token |
| order_number     | string | The order number. |
| order_items      | json | The list of order items, see [schema/order-item.json]. |
| seller           | string | The seller's NewID  |
| customer         | string | The customer's NewID |
| broker           | string | The broker's NewID. optional.  |

#### Example Parameters
TBD

#### Returns
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| proof_hash           | string | The proof hash                             |

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
    "proof_hash": "...."
}
```

*** 

### newnet_getProofCache
Get the proof information by given proof hash.

#### Path
`
/newnet/cache/proof/:proof_hash/
`

#### Method
`GET`

#### Parameters
none

#### Example Parameters
TBD

#### Returns
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| uuid           | string | request uuid                             |
| dapp_id           | string | Decentralized Application Id                             |
| protocol | string    | protocol name. The default is "HEP".                |
| version | string    | protocol version. The example is "1.0".                |
| ts        | number    | timestamp                                  |
| nonce            | string | random string or auto-increment sequence                              |
| sign_type        | string | Signature Type,aka cryptographic algorithm |
| signature        | string | signature hex string by application owner |
| action | string | "hep.proof.submit" |
| expired          | number | Expired timestamp                             |
| description      | string | The order description |
| price_currency   | string | symbol of fiat or digital token, such as USD, CNY, NEW,BTC,ETH
| total_price      | string | amount of fiat or digital token, unit is the minimum unit of given fiat or digital token |
| order_number     | string | The order number. |
| order_items      | json | The list of order items, see [schema/order-item.json]. |
| seller           | string | The seller's NewID  |
| customer         | string | The customer's NewID |
| broker           | string | The broker's NewID.  |

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
    "content": {
        "dapp_id": "...",
        "protocol": "....",
        "version": "1.0",
        "ts": 1559122027,
        "nonce": "...",
        "signature": "...",
        "action": "...",
        "expired": 1559122027,
        ...
    },
    "sign_type": "...",
    "signature": "...",
    "action": "hep.proof.submit",
    "uuid": "...",
}
```


## Proof

### proof_submitProof

In this case, we should check the delegate balance of dapp.

#### Path
`
/proof/
`

#### Parameters
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| content      | json | The content of proof. |
| sign_type        | string | Signature Type,aka cryptographic algorithm |
| signature      | string | The signature by Dapp owner. |

##### Order Proof Parameters
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| type           | string | The value is "order"                             |
| description      | string | The order description |
| price_currency   | string | symbol of fiat or digital token, such as USD, RMB, NEW,BTC,ETH
| total_price      | string | amount of fiat or digital token, unit is the minimum unit of given fiat or digital token |
| order_number     | string | The order number. |
| order_items      | json | The list of order items, see [schema/order-item.json]. |
| seller           | string | The seller's NewID  |
| customer         | string | The customer's NewID |
| broker           | string | The broker's NewID. optional.  |

#### Example Parameters
TBD

#### Returns
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| proof_hash           | string | The proof hash                             |

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
    "proof_hash": "...."
}
```

*** 

### proof_getProof
Get the proof information by given proof hash.

#### Path
`
/proof/:proof_hash/
`

#### Method
`GET`

#### Parameters
none

#### Example Parameters
TBD

#### Returns
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| dapp_id           | string | Decentralized Application Id                             |
| protocol | string    | protocol name. The default is "HEP".                |
| version | string    | protocol version. The example is "1.0".                |
| ts        | number    | timestamp                                  |
| nonce            | string | random string or auto-increment sequence                              |
| sign_type        | string | Signature Type,aka cryptographic algorithm |
| signature        | string | signature hex string by application owner |
| action           | string | The value is "pay"                             |
| expired          | number | Expired timestamp                             |
| description      | string | The order description |
| price_currency   | string | symbol of fiat or digital token, such as USD, CNY, NEW,BTC,ETH
| total_price      | string | amount of fiat or digital token, unit is the minimum unit of given fiat or digital token |
| order_number     | string | The order number. |
| order_items      | json | The list of order items, see [schema/order-item.json]. |
| seller           | string | The seller's NewID  |
| customer         | string | The customer's NewID |
| broker           | string | The broker's NewID.  |

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
    ...
    "content": {
        "dapp_id": "...",
        "protocol": "....",
        "version": "1.0",
        "ts": 1559122027,
        "nonce": "...",
        "signature": "...",
        "action": "...",
        "expired": 1559122027,
        ...
    },
    "sign_type": "...",
    "signature": "...",
}
```

***

### proof_confirmProof

#### Path
`
/proof/:proof_hash/confirm/
`

#### Parameters
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| confirmer        | string | The confirmer's NewID |
| tx        | string | The body of transaction. |
| sign_type        | string | Signature Type,aka cryptographic algorithm. |
| signature      | string | The signature by confirmer. |

#### Example Parameters
TBD

#### Returns
none

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
}
```

*** 

### proof_cancelProof

#### Path
`
/proof/:proof_hash/cancel/
`
#### Method
`DELETE`

#### Parameters
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| tx        | string | The body of transaction. |
| sign_type        | string | Signature Type,aka cryptographic algorithm. |
| signature      | string | The signature by DApp owner. |

#### Example Parameters
TBD

#### Returns
none

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
}
```

## DApp

### dapp_profile

#### Path
`
/dapp/:dapp_id/
`

#### Parameters
none

#### Example Parameters
TBD

#### Returns
| Field            | Type   | Notes                                      |
| ---              | ---    | ---                                        |
| dapp_id           | string | Decentralized Application Id                             |
| dapp_name           | string | Decentralized Application name                             |
| icon           | string | Icon of Application                             |
| public_key           | string | Public key of Dapp                             |
| new_address | string | The Newchain Address, the example is NEW182.... |
| dapp_type | int | The DApp type |
| dapp_category | int | The DApp category |
| auth_login_callback  | string | For Mobile Native DApp, it is redirect schema; For website DApp, it is callback url; For  NewDApp, it is HEP-based url.       |
| pay_order_callback | string | For Mobile Native DApp, it is redirect schema; For website DApp, it is callback url; For  NewDApp, it is HEP-based url. |
| proof_submit_callback | string | For Mobile Native DApp, it is redirect schema; For website DApp, it is callback url; For  NewDApp, it is HEP-based url. |

#### Example
```
// Request
curl -X POST --data '{}'


// Response
{
    ....    
}
```


### newid

#### Path
`
/newid/:newid/
`

#### Parameters
none

#### Returns
| Field | Type | Notes |
| --- | --- | --- |
| newid | string | NewID |
| public_key | string | newid public_key |
| new_address | string | The NewChain wallet address |

#### Example
```
// Response
{
    "newid": "NEWID...",
    "public_key": "0x...",
    "new_address": "NEW182...",
}
```
